<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supply Department</title>
    <link rel="stylesheet" href="supply_send_to_admin.css">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <h2>Menu</h2>
        <ul>
            <li><a href="supply_department.html">Send to Admin</a></li>
            <li><a href="supply_document.html">Documents</a></li>
            <li><a href="supply_inventory.html">Inventory</a></li>
            <li><a href="supply_uploaded_files.html">Uploaded Files</a></li>
        </ul>
    </aside>

        <!-- Content -->
        <div class="content">
            <header>
                <div class="hamburger-menu">
                    <div class="hamburger-icon"></div>
                </div>
            </header>
        </div>

    <div class="container">
        <!-- Add your department-specific content here -->
        <h2>Send Files to Admin for Approval</h2>
        <form id="sendToAdminForm" action="send_to_admin.php" method="post">
            <ul class="file-list">
                <?php
                // Include the PHP code to fetch the file list here
                // Database connection parameters
                $servername = "localhost";
                $username = "root";
                $password = "";
                $dbname = "zenith";
        
                // Create connection
                $conn = new mysqli($servername, $username, $password, $dbname);
        
                // Check connection
                if ($conn->connect_error) {
                    die("Connection failed: " . $conn->connect_error);
                }
        
                // Fetch list of uploaded files
                $sql = "SELECT file_id, file_name FROM files"; // Assuming your files table has columns for file_id and file_name
                $result = $conn->query($sql);

                // Check if there are any files
                if ($result->num_rows > 0) {
                    // Output data of each row
                    while ($row = $result->fetch_assoc()) {
                        // Output file name as a list item with checkbox
                        echo '<li><label><input type="checkbox" name="files[]" value="' . $row["file_id"] . '"> ' . $row["file_name"] . '</label></li>';
                    }
                } else {
                    // If no files found, display a message
                    echo "<li>No files found</li>";
                }

                // Close connection
                $conn->close();
                ?>
            </ul>
            <button type="submit">Send to Admin</button>
        </form>

        <!-- Add a table to display approval status -->
<table class="approval-status">
    <thead>
        <tr>
            <th>File Name</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
        <!-- PHP code to fetch and display approval status -->
        <?php
        // Your PHP code to fetch approval status for each file and display it in the table
        ?>
    </tbody>
</table>

        
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $('.hamburger-icon').click(function() {
                $('.sidebar').toggleClass('active');
            });

            // Form submission handler
            $('#sendToAdminForm').submit(function(event) {
                event.preventDefault(); // Prevent default form submission
                var formData = $(this).serialize(); // Serialize form data
                // AJAX request to send selected files to admin
                $.ajax({
                    url: 'send_to_admin.php', // PHP script to handle sending to admin
                    type: 'POST',
                    data: formData,
                    success: function(response) {
                        alert('Files sent to admin for approval.'); // Show success message
                        // Optionally, you can update the UI or perform other actions
                    },
                    error: function(xhr, status, error) {
                        console.error('Error sending files:', error); // Log error
                        alert('Failed to send files to admin. Please try again later.'); // Show error message
                    }
                });
            });
        });
    </script>
</body>
</html>