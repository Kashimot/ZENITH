<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documents</title>
    <link rel="stylesheet" href="facilities_document.css">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <h2>Menu</h2>
        <ul>
            <li><a href="facilities_management.html" class="nav-btn">Home</a></li>
            <li><a href="facilities_send_to_admin.html" class="nav-btn">Send to Admin</a></li>
        </ul>
    </aside>

    <!-- Content -->
    <div class="content">
        <header>
            <div class="hamburger-menu">
                <div class="hamburger-icon"></div>
            </div>
        </header>
    </div>

    <div class="container">
        <!-- Add your department-specific content here -->
        <p>Welcome to the Facilities Management Documents Page.</p>
        <!-- File upload form -->
<div id="uploadForm">
    <h2>Upload Documents</h2>
    <form id="fileUploadForm" enctype="multipart/form-data">
        <!-- Input field for the new filename (optional) -->
        <input type="text" name="newFilename" id="newFilename" placeholder="New Filename">
        <input type="file" name="fileToUpload" id="fileToUpload" accept=".pdf,.doc,.docx,.txt" required>
        <button type="submit" id="uploadBtn">Upload</button>
    </form>
    <div id="errorMsg"></div>
</div>

<div class="container">
    <!-- Approved Files Container -->
    <div class="approved-files">
        <h2>Approved Files</h2>
        <ul id="approvedFilesList">
            <!-- List of approved files will be dynamically populated here -->
        </ul>
    </div>

    <!-- Rejected Files Container -->
    <div class="rejected-files">
        <h2>Rejected Files</h2>
        <ul id="rejectedFilesList">
            <!-- List of rejected files will be dynamically populated here -->
        </ul>
    </div>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $('.hamburger-icon').click(function() {
                $('.sidebar').toggleClass('active');
            });

            // File upload form submission handler
            $('#fileUploadForm').submit(function(event) {
                event.preventDefault(); // Prevent default form submission
                var formData = new FormData(this); // Create FormData object to handle file upload

                // AJAX request to upload file
                $.ajax({
                    url: 'upload_document.php', // PHP script to handle file upload
                    type: 'POST',
                    data: formData,
                    contentType: false,
                    processData: false,
                    success: function(response) {
                        // If upload successful, display uploaded file in the list
                        $('#fileList').append('<li><a href="#">' + response + '</a></li>');
                        $('#errorMsg').empty(); // Clear any previous error messages
                    },
                    error: function(xhr, status, error) {
                        // If upload failed, display error message
                        $('#errorMsg').text('Error: ' + xhr.responseText);
                    }
                });
            });

            // AJAX request to fetch and display list of uploaded files
            $.ajax({
                url: 'fetch_documents.php', // PHP script to fetch uploaded documents
                type: 'GET',
                success: function(response) {
                    // Parse JSON response and display each file in the list
                    var fileList = JSON.parse(response);
                    fileList.forEach(function(file) {
                        $('#fileList').append('<li><a href="#">' + file + '</a></li>');
                    });
                },
                error: function(xhr, status, error) {
                    console.error('Error fetching documents:', error); // Log error
                }
            });
        });
        $(document).ready(function() {
    // Function to add time and date
    $('#addTimeDateForm').submit(function(event) {
        event.preventDefault(); // Prevent form submission
        var facility = $('#facility').val();
        var time = $('#time').val();
        var date = $('#date').val();

        // AJAX request to store the data in the database
        $.ajax({
            url: 'store_facility_time_date.php',
            type: 'POST',
            data: { facility: facility, time: time, date: date },
            success: function(response) {
                alert('Time and date added successfully!');
                // Optionally, update the UI to reflect the changes
            },
            error: function(xhr, status, error) {
                console.error('Error adding time and date:', error);
            }
        });
    });
});

    </script>
</body>
</html>
